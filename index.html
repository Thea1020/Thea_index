<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>今日摸鱼</title>
    <style>
        body {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            overflow: hidden;
            font-family: "SimSun", "宋体", sans-serif;
            position: relative;
            background: url('2Dgif0001.gif'), url('微信图片_20241024174619.jpg') no-repeat center center;
            background-size: cover;
        }
        #randomNumber {
            font-size: 48px;
            color: white;
            margin-top: 8px;
            opacity: 0;
            transition: opacity 0.5s;
        }
        #imageBox {
            width: 300px;
            height: 100px;
            overflow: hidden;
            position: relative;
            margin-bottom: 10px;
        }
        #imageA, #imageB {
            position: absolute;
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: opacity 0.5s ease-in-out; /* 修改为ease-in-out */
        }
        #imageB {
            opacity: 0; /* 初始透明度为0 */
        }
        #startButton {
            position: absolute;
            bottom: 315px;
            width: 200px;
            height: 100px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div id="imageBox">
        <img id="imageA" src="imageA.png" alt="图片A">
        <img id="imageB" src="imageB.png" alt="图片B">
    </div>
    <div id="randomNumber"></div>
    <video id="transitionVideo" src="WeChat_20241024172224.mp4" autoplay muted style="display: none; position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover;"></video>

    <img id="startButton" src="微信图片_20241024173308.png" alt="开始按钮" onclick="start();">

    <script>
        function getRandomNumber() {
            const today = new Date().toISOString().split('T')[0];
            const storedDate = localStorage.getItem('date');
            const storedNumber = localStorage.getItem('randomNumber');

            if (storedDate === today) {
                return storedNumber;
            } else {
                const newRandomNum = Math.floor(Math.random() * 9) + 1;
                localStorage.setItem('date', today);
                localStorage.setItem('randomNumber', newRandomNum);
                return newRandomNum;
            }
        }

        function start() {
            document.getElementById('startButton').style.display = 'none'; // 隐藏开始按钮
            const imageA = document.getElementById('imageA');
            const imageB = document.getElementById('imageB');

            // 切换透明度
            imageA.style.opacity = '0';
            imageB.style.opacity = '1';

            // 显示随机数
            const randomNum = getRandomNumber();
            const resultElement = document.getElementById('randomNumber');
            resultElement.innerHTML = randomNum;

            // 淡入随机数
            setTimeout(function() {
                resultElement.style.opacity = '1';
            }, 100);

            // 2秒后显示转场视频并跳转
            setTimeout(function() {
                const transitionVideo = document.getElementById('transitionVideo');
                transitionVideo.style.display = 'block';
                transitionVideo.play();

                // 隐藏背景和按钮
                document.body.style.background = 'none';
                imageA.style.opacity = '0';
                imageB.style.opacity = '0';
                resultElement.style.opacity = '0';

                // 监听视频播放结束事件
                transitionVideo.onended = function() {
                    transitionVideo.style.display = 'none';
                    const selectedImage = document.getElementById('img' + randomNum);
                    selectedImage.classList.add('show');

                    selectedImage.onclick = function() {
                        window.location.href = '下一页.html';
                    };
                };
            }, 2000);
        }
    </script>
</body>
</html>
